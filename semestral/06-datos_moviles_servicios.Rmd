---
output:
  word_document:
    reference_docx: word_report.docx
graphics: yes
---

```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE,
                      message = FALSE)

options(scipen = 10000)

# Theme
source('../common.R')

servicios <- import_datos_servicios_moviles()

```

# 89. Servicios móviles
```{r}
serie_109_vieja <- tibble(
  fecha = seq(ymd('2010-12-01'), 
              ymd('2018-12-01'), by = '6 months'),
  numeric = c(4437158, 4590164, 4757425, 4825906, 4995459, 
              5128213, 5267947, 5358325, 5497094, 5512691,
              5495186, 5402349, 5420276, 5377312, 5391150,
              5326789, 5436570))



serie_109_nueva <- servicios %>% 
  filter(servicio %in% c("Internet Móvil",
                         "M2M",
                         "Suscriptores a la telefonía móvil celular")) %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(fecha) %>% 
  summarize(numeric = sum(numeric, na.rm = TRUE)) 

serie_109 <- bind_rows(serie_109_vieja, serie_109_nueva) %>% 
  transmute(semester = semester(fecha), year = year(fecha), numeric)

serie_109 %>%
  filter(year > 2016) %>%
  serie_historica_semestral_stock(numeric, nudge_text = 3e5)
```



<br />

<br />

<br />



## 90. Servicios móviles por operador (`r FECHA_TITULO_STOCK`)

```{r}
serie_110 <- servicios %>% 
  filter(servicio %in% c("Internet Móvil",
                         "M2M",
                         "Suscriptores a la telefonía móvil celular")) %>% 
  filter(year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL)) %>% 
  group_by(empresa) %>% 
  summarize(numeric = sum(numeric, na.rm = TRUE))

 serie_110 %>% 
  pie_chart(numeric, empresa) %>% 
  print
```


<br />

<br />

<br />



## 91. Servicios móviles por tipo (`r FECHA_TITULO_STOCK`)

```{r}
serie_111 <- servicios %>% 
  filter(servicio %in% c("Internet Móvil",
                         "M2M",
                         "Suscriptores a la telefonía móvil celular")) %>% 
  filter(year(fecha) >= year(FECHA_INFORME_SEMESTRAL)) %>% 
  filter(month(fecha) %in% month(FECHA_INFORME_SEMESTRAL)) %>% 
  group_by(servicio) %>% 
  summarize(numeric = sum(numeric, na.rm = TRUE))

serie_111 %>% 
  pie_chart(numeric, servicio, nudge_x =c(-1,1,0)) %>% 
  print
```



<br />

<br />

<br />



## 92. Suscriptores a la telefonía móvil celular
```{r}
serie_112 <- servicios %>% 
  filter(servicio == "Suscriptores a la telefonía móvil celular") %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_112 %>% 
  serie_historica_semestral_stock(val, nudge_text = 300e4) 
```


<br />

<br />

<br />



## 93. Suscriptores a la telefonía móvil celular por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_113 <- servicios %>% 
  filter(servicio == "Suscriptores a la telefonía móvil celular") %>%
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_113 %>% 
  pie_chart(val, empresa) %>% 
  print
```



<br />

<br />

<br />




## 94. Servicios M2M
```{r}
serie_114 <- servicios %>% 
  filter(servicio == "M2M") %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_114 %>% 
  serie_historica_semestral_stock(val, nudge_text = 2e4)
```


<br />

<br />

<br />



## 95. Servicios M2M por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_115 <- servicios %>% 
  filter(servicio == "M2M") %>%
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_115 %>% 
  pie_chart(val, empresa) %>% 
  print
```


<br />

<br />

<br />




## 96. Internet móvil (computadoras y tablets)
```{r}
serie_116 <- servicios %>% 
  filter(servicio == "Internet Móvil") %>%
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(year(fecha) >= 2016) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(year >= 2018)

serie_116 %>% 
  serie_historica_semestral_stock(val, nudge_text = 2e4)
```



<br />

<br />

<br />



## 97. Internet móvil (computadoras y tablets) por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_117 <-  servicios %>% 
  filter(servicio == "Internet Móvil") %>%
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_117 %>% 
  pie_chart(val, empresa, 
              nudge_radio = c(.7, .9, .9),
              nudge_x = c(0, -1, 0)) %>% 
  print
```



<br />

<br />

<br />



## 98. Suscriptores de banda ancha móvil
```{r}
serie_118 <-  servicios %>% 
  filter(servicio == "Suscriptores de banda ancha móvil") %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_118 %>% 
  serie_historica_semestral_stock(val, nudge_text = 2e5)
```



<br />

<br />

<br />



## 99. Suscriptores de banda ancha móvil por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_119 <- servicios %>% 
  filter(servicio == "Suscriptores de banda ancha móvil") %>%
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_119 %>% 
  pie_chart(val, empresa) %>% 
  print
```


<br />

<br />

<br />



## X. Servicios móviles según forma de pago (`r FECHA_TITULO_STOCK`)

```{r}
serie_120 <- servicios %>% 
  filter(servicio %in% c(
    "Suscriptores a la telefonía móvil celular",
    #"Suscriptores de banda ancha móvil",
    "M2M",
    "Internet Móvil")) %>%
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(pago) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_120 %>% 
  pie_chart(val, pago) %>% 
  print
```



<br />

<br />

<br />



## X. Servicios Móviles Prepagos
```{r}

serie_pre_2018 <- tibble(
  year=c(rep(2017, 2), rep(2018, 2)),
  semester = c(rep(c(1, 2), 2)),
  val=c(3226685, 3263337, 3130398, 3141807)
)

serie_post_2019 <-  servicios %>% 
  filter(servicio %in% c(
    "Suscriptores a la telefonía móvil celular",
    #"Suscriptores de banda ancha móvil",
    "M2M",
    "Internet Móvil")) %>%
  filter(pago == "Prepago") %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

bind_rows(serie_pre_2018, serie_post_2019) %>% 
  serie_historica_semestral_stock(val, nudge_text = 2e5)
```


<br />

<br />

<br />




## X. Servicios móviles prepagos por operador  (`r FECHA_TITULO_STOCK`)
```{r}
serie_120 <- servicios %>% 
  filter(servicio %in% c(
    "Suscriptores a la telefonía móvil celular",
    #"Suscriptores de banda ancha móvil",
    "M2M",
    "Internet Móvil")) %>%
  filter(pago == "Prepago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_120 %>% 
  pie_chart(val, empresa) %>% 
  print
```



<br />

<br />

<br />




## X. Servicios móviles prepagos por tipo  (`r FECHA_TITULO_STOCK`)
```{r}
serie_120 <- servicios %>% 
  filter(servicio %in% c(
    "Suscriptores a la telefonía móvil celular",
    #"Suscriptores de banda ancha móvil",
    "M2M",
    "Internet Móvil")) %>%
  filter(pago == "Prepago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(servicio) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_120 %>% 
  pie_chart(val, servicio, nudge_x = c(0, 6, 0),
                           nudge_y = c(0, -2, 0)) %>% 
  print
```



<br />

<br />

<br />




## X. Servicios móviles pospagos
```{r}

serie_pre_2018 <- tibble(
  year=c(rep(2017, 2), rep(2018, 2)),
  semester = c(rep(c(1, 2), 2)),
  val=c(2099924, 2173233, 2308992, 2525824)
)


serie_121 <-  servicios %>% 
  filter(servicio %in% c(
    "Suscriptores a la telefonía móvil celular",
    #"Suscriptores de banda ancha móvil",
    "M2M",
    "Internet Móvil")) %>%
  filter(pago == "Pospago") %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_121 %>% 
  serie_historica_semestral_stock(val, nudge_text = 2e5)
```



<br />

<br />

<br />





## X. Servicios móviles pospagos por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_120 <- servicios %>% 
  filter(servicio %in% c(
    "Suscriptores a la telefonía móvil celular",
    #"Suscriptores de banda ancha móvil",
    "M2M",
    "Internet Móvil")) %>%
  filter(pago == "Pospago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_120 %>% 
  pie_chart(val, empresa) %>% 
  print
```


<br />

<br />

<br />




## X. Servicios móviles pospagos por tipo (`r FECHA_TITULO_STOCK`)
```{r}
serie_120 <- servicios %>% 
  filter(servicio %in% c(
    "Suscriptores a la telefonía móvil celular",
    #"Suscriptores de banda ancha móvil",
    "M2M",
    "Internet Móvil")) %>%
  filter(pago == "Pospago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(servicio) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_120 %>% 
  pie_chart(val, servicio) %>% 
  print
```


<br />

<br />

<br />




## 100. Suscriptores de banda ancha móvil según forma de pago (`r FECHA_TITULO_STOCK`)
```{r}
serie_120 <- servicios %>% 
  filter(servicio == "Suscriptores de banda ancha móvil") %>%
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(pago) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_120 %>% 
  pie_chart(val, pago) %>% 
  print
```


<br />

<br />

<br />




## 107. Suscriptores prepagos de banda ancha móvil
```{r}
serie_127 <- servicios %>% 
  filter(servicio == "Suscriptores de banda ancha móvil") %>%
  filter(pago == "Prepago") %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(year(fecha) >= 2019) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_127 %>% 
  serie_historica_semestral_stock(val, nudge_text = 1e5) 
```


<br />

<br />

<br />



## 108. Suscriptores prepagos de banda ancha móvil por operador (`r FECHA_TITULO_STOCK`)

```{r}
serie_128 <- servicios %>% 
  filter(servicio == "Suscriptores de banda ancha móvil") %>%
  filter(pago == "Prepago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(val > 0)

serie_128 %>%
  pie_chart(val, empresa) %>% 
  print
```




<br />

<br />

<br />




# X. Suscriptores pospagos de banda ancha móvil

```{r}
serie_121 <-  servicios %>% 
  filter(servicio %in% c(
    "Suscriptores de banda ancha móvil")) %>%
  filter(pago == "Pospago") %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_121 %>% 
  serie_historica_semestral_stock(val, nudge_text = 2e5)
```



<br />

<br />

<br />




## 116. Suscriptores pospagos de banda ancha móvil por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_136 <- servicios %>% 
  filter(servicio == "Suscriptores de banda ancha móvil") %>%
  filter(pago == "Pospago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(val > 0)

serie_136 %>% 
  pie_chart(val, empresa) %>% 
  print
```


<br />

<br />

<br />




## 101. Suscriptores a la telefonía móvil según forma de pago (`r FECHA_TITULO_STOCK`)
```{r}
serie_121 <- servicios %>% 
  filter(year(fecha) == year(FECHA_INFORME_SEMESTRAL), month(fecha) == month(FECHA_INFORME_SEMESTRAL)) %>% 
  filter(servicio %in% "Suscriptores a la telefonía móvil celular") %>% 
  group_by(pago) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_121 %>% 
  pie_chart(val, pago) %>% 
  print
```



<br />

<br />

<br />




## 102. Suscriptores prepagos a la telefonía móvil
```{r}
# Falta filtrar junio y diciembre
serie_122 <- servicios %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(pago == "Prepago") %>% 
  filter(servicio %in% c("Suscriptores a la telefonía móvil celular")) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_122 %>% 
  serie_historica_semestral_stock(val, nudge_text = 2e5)
```



<br />

<br />

<br />




## 103. Suscriptores prepagos a la telefonía móvil por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_123 <- servicios %>% 
  filter(servicio == "Suscriptores a la telefonía móvil celular") %>% 
  filter(pago == "Prepago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL)) %>% 
  filter(year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>% 
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(val > 0)

serie_123 %>% 
  pie_chart(val, empresa) %>% 
  print


```


<br />

<br />

<br />



## 109. Suscriptores pospagos a la telefonía móvil
```{r}
serie_129 <- servicios %>% 
  filter(year(fecha) >= 2019) %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(servicio %in% c("Suscriptores a la telefonía móvil celular")) %>% 
  filter(pago == "Pospago") %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_129 %>% 
  serie_historica_semestral_stock(val, nudge_text = 1e5)
```


<br />

<br />

<br />



## 110. Suscriptores pospagos a la telefonía móvil celular por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_130 <- servicios %>% 
  filter(servicio == "Suscriptores a la telefonía móvil celular") %>% 
  filter(pago == "Pospago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL)) %>% 
  filter(year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>% 
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(val > 0)

serie_130 %>% 
  pie_chart(val, empresa) %>% 
  print
```



<br />

<br />

<br />



# X. Internet móvil (computadora y tablets) según forma de pago (`r FECHA_TITULO_STOCK`)
```{r}
serie_125 <-  servicios %>% 
  filter(servicio == "Internet Móvil") %>%
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(pago) %>% 
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(val > 0)

serie_125 %>% 
  pie_chart(val, pago) %>% 
  print
```



<br />

<br />

<br />



## 104. Internet móvil prepago (computadoras y tablets)

```{r}
serie_124 <- servicios %>% 
  filter(servicio == "Internet Móvil") %>%
  filter(pago == "Prepago") %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(year(fecha) >= 2016) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(year >= 2018)

serie_124 %>% 
  serie_historica_semestral_stock(val, nudge_text = 1e4)
```



<br />

<br />

<br />




## 105. Internet móvil prepago (computadoras y tablets) por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_125 <-  servicios %>% 
  filter(servicio == "Internet Móvil") %>%
  filter(pago == "Prepago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(val > 0)

serie_125 %>% 
  pie_chart(val, empresa) %>% 
  print
```



<br />

<br />

<br />



## 111. Internet móvil pospago (computadoras y tablets)
```{r}
serie_131 <- servicios %>% 
  filter(servicio == "Internet Móvil") %>%
  filter(pago == "Pospago") %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(year(fecha) >= 2016) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_131 %>% 
  serie_historica_semestral_stock(val, nudge_text = 3e4)
```



<br />

<br />

<br />



## 112. Internet móvil pospago (computadoras y tablets) por operador (`r FECHA_TITULO_STOCK`)

```{r}
serie_132 <-  servicios %>% 
  filter(servicio == "Internet Móvil") %>%
  filter(pago == "Pospago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE)) %>% 
  filter(val > 0)

serie_132 %>% 
  pie_chart(val, empresa, 
              nudge_x = c(0, -1, 1),
              nudge_radio = c(.7, .8, .8) ) %>% 
  print
```


<br />

<br />

<br />




## 113. Servicios M2M pospagos
```{r}
serie_133 <- servicios %>% 
  filter(servicio == "M2M") %>%
  filter(pago == "Pospago") %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(year(fecha) >= 2019) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_133 %>% 
  serie_historica_semestral_stock(val, nudge_text = 3e4)
```


<br />

<br />

<br />



## 114. Servicios M2M posagos por operador (`r FECHA_TITULO_STOCK`)

```{r}
serie_134 <- servicios %>% 
  filter(servicio == "M2M") %>%
  filter(pago == "Pospago") %>% 
  filter(month(fecha) == month(FECHA_INFORME_SEMESTRAL), 
         year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>%
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_134 %>%
  pie_chart(val, empresa) %>%
  print
```



<br />

<br />

<br />




## 106. Servicios M2M prepagos
```{r}

# Faltan filtro de fechas
serie_126 <- servicios %>% 
  filter(servicio == "M2M") %>%
  filter(pago == "Prepago") %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(year(fecha) >= 2019) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>%
  summarize(val = sum(numeric, na.rm = TRUE))

serie_126 %>% 
  serie_historica_semestral_stock(val, nudge_text = .15)
```



<br />

<br />

<br />




## 117. Tráfico de datos de servicios de banda ancha móvil (terabytes)

```{r include=FALSE}
trafico <- import_datos_trafico_moviles()
```


```{r}
serie_137 <- trafico %>%
    filter(servicio %in%  c("Banda Ancha Móvil",
                            "Servicios de Banda Ancha Móvil")) %>% 
    group_by(year=year(fecha), semester=semester(fecha)) %>% 
    summarize(val = sum(numeric, na.rm = TRUE))

serie_137 %>% 
  serie_historica_semestral_flujo(val, 1e4)
  
```



<br />

<br />

<br />



## 118. Tráfico de datos de servicios de banda ancha móvil (terabytes) por operador (`r FECHA_TITULO_FLUJO`)
```{r}
serie_138 <- trafico %>% 
    filter(year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>% 
    filter(servicio %in%  c("Banda Ancha Móvil",
                            "Servicios de Banda Ancha Móvil")) %>% 
    group_by(empresa) %>% 
    summarize(val = sum(numeric, na.rm = TRUE))

serie_138 %>% 
  pie_chart(val, empresa) %>% 
  print
```



<br />

<br />

<br />



## 119. Tráfico de datos de servicios de banda ancha móvil prepagos (terabytes) (`r FECHA_TITULO_FLUJO`)
```{r}
serie_139 <- trafico %>%
  filter(pago == "Prepago") %>% 
  filter(servicio %in%  c("Banda Ancha Móvil",
                          "Servicios de Banda Ancha Móvil")) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_139 %>% 
  serie_historica_semestral_flujo(val, 3e3)

```



<br />

<br />

<br />


## 120. Tráfico de datos de servicios de banda ancha móvil prepagos (terabytes) por operador (`r FECHA_TITULO_FLUJO`)
```{r}
serie_140 <- trafico %>% 
  filter(pago == "Prepago") %>% 
  filter(year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>% 
  filter(servicio %in%  c("Banda Ancha Móvil",
                          "Servicios de Banda Ancha Móvil")) %>% 
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_140 %>% 
  pie_chart(val, empresa) %>% 
  print
```



<br />

<br />

<br />



## 121. Tráfico de datos de servicios de banda ancha móvil pospagos (terabytes)
```{r}
serie_141 <- trafico %>%
  filter(pago == "Pospago") %>% 
  filter(servicio %in%  c("Banda Ancha Móvil",
                          "Servicios de Banda Ancha Móvil")) %>% 
  group_by(year=year(fecha), semester=semester(fecha)) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_141 %>% 
  serie_historica_semestral_flujo(val, nudge_text=4e3)
```




<br />

<br />

<br />



## 122. Tráfico de datos de servicios de banda ancha móvil pospagos (terabytes) por operador (`r FECHA_TITULO_FLUJO`)
```{r}
serie_142 <- trafico %>% 
  filter(pago == "Pospago") %>% 
  filter(year(fecha) == year(FECHA_INFORME_SEMESTRAL)) %>% 
  filter(servicio %in%  c("Banda Ancha Móvil",
                          "Servicios de Banda Ancha Móvil")) %>% 
  group_by(empresa) %>% 
  summarize(val = sum(numeric, na.rm = TRUE))

serie_142 %>% 
  pie_chart(val, empresa) %>% 
  print
```


<br />

<br />

<br />

