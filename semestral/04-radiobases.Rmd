---
output:
  word_document:
    reference_docx: word_report.docx
graphics: yes
---

```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE,
                      message = FALSE)

options(scipen = 10000)




# Theme
source('../common.R')

radiobases <- import_radiobases()


month_label <- function(x) {
  y <- as_date(x)
  glue::glue("{month(x)}/{format(y, '%y')}")
}


```


# 4. Servicios de Telefonía móvil

## 70. Cantidad de radiobases
```{r}
radiobases %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(tipo == "Radiobases (total)") %>% 
  group_by(year = year(fecha), semester = semester(fecha)) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE)) %>% 
  serie_historica_semestral_stock(radiobases, nudge_text = 5e2)
```


## 71. Cantidad de radiobases por departamento (`r FECHA_TITULO_STOCK`)
```{r}
tabla_91 <- radiobases %>% 
  filter(tipo == "Radiobases (total)") %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  group_by(depto) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE))

tabla_91 %>% 
  barras_horizontales(radiobases, depto, nudge_text = 1e2)
```

## 72. Cantidad de radiobases por operador (`r FECHA_TITULO_STOCK`)

```{r}
tabla_92 <-  radiobases %>% 
  filter(tipo == "Radiobases (total)") %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  group_by(empresa) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE))

g_92 <- tabla_92 %>% 
  pie_chart(radiobases, empresa) %>% 
  print
```

## 73. Cantidad de radiobases GSM
```{r}
radiobases %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(tipo == "Radiobases (GSM)") %>% 
  group_by(year = year(fecha), semester = semester(fecha)) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE)) %>% 
  serie_historica_semestral_stock(radiobases, nudge_text = 5e2)
```


## 74. Cantidad de radiobases GSM por departamento (`r FECHA_TITULO_STOCK`)

```{r}
tabla_94 <- radiobases %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  filter(tipo == "Radiobases (GSM)") %>% 
  group_by(depto) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE))

tabla_94 %>% 
  barras_horizontales(radiobases, depto, nudge_text = 20)
```


## 75. Cantidad de radiobases GSM por operador (`r FECHA_TITULO_STOCK`)

```{r}
tabla_95 <- radiobases %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  filter(tipo == "Radiobases (GSM)") %>% 
  group_by(empresa) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE))

tabla_95 %>% 
  pie_chart(radiobases, empresa) %>% 
  print
```

## 76. Cantidad de radiobases 3G
```{r}
radiobases %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(tipo == "Radiobases (3G)") %>% 
  group_by(year = year(fecha), semester = semester(fecha)) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE)) %>% 
  serie_historica_semestral_stock(radiobases, nudge_text = 5e2)
```


## 77. Cantidad de radiobases 3G por departamento (`r FECHA_TITULO_STOCK`)

```{r}
tabla_97 <- radiobases %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  filter(tipo == "Radiobases (3G)") %>% 
  group_by(depto) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE))

tabla_97 %>% 
  barras_horizontales(radiobases, depto, nudge_text = 30)
```

## 78. Cantidad de radiobases 3G por operador (`r FECHA_TITULO_STOCK`)

```{r}
tabla_98 <-  radiobases %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  filter(tipo == "Radiobases (3G)") %>% 
  group_by(empresa) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE)) 

 tabla_98 %>% 
  pie_chart(radiobases, empresa) %>% 
   print
```


## 79. Cantidad de radiobases LTE
```{r}
radiobases %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  filter(tipo == "Radiobases (LTE)") %>% 
  group_by(year = year(fecha), semester = semester(fecha)) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE)) %>% 
  serie_historica_semestral_stock(radiobases, nudge_text = 5e2)
```


## 80. Cantidad de radiobases LTE por departamento (`r FECHA_TITULO_STOCK`)

```{r}
tabla_100 <- radiobases %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  filter(tipo == "Radiobases (LTE)") %>% 
  group_by(depto) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE))

 tabla_100 %>% 
  barras_horizontales(radiobases, depto, nudge_text = 60)
```


## 81. Cantidad de radiobases LTE por operador (`r FECHA_TITULO_STOCK`)

```{r}
tabla_101 <- radiobases %>% 
  filter(fecha == FECHA_INFORME_SEMESTRAL) %>% 
  filter(tipo == "Radiobases (LTE)") %>% 
  group_by(empresa) %>% 
  summarize(radiobases = sum(val, na.rm = TRUE))

tabla_101 %>% 
  pie_chart(radiobases, empresa) %>% 
  print
```

