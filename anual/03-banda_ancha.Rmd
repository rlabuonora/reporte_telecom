---
title: "Banda Ancha"
output:
  word_document:
    reference_docx: word_report.docx
    
graphics: yes
---
```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE,
                      message=FALSE,
                      fig.width = 7, 
                      fig.height = 4.5)

options(scipen = 10000)

source('../common.R')

banda_ancha_servicios <- import_banda_ancha_servicios()

```

# 3. Transmisión de datos e internet


## 42. Servicios de banda ancha fija
```{r}
# g_63
serie_63 <- tribble(
           ~year, ~numeric,
          2010,  382948,
          2011,  472876,
          2012,  580669,
          2013,  737078,
          2014,  840261,
          2015,  900888,
          2016,  921677,
          2017,  949929,
          2018,  977448,
          2019,  1012467)

serie_63 %>% 
  serie_historica_anual(numeric, nudge_text = 5e4)
```



## 43. Servicios de banda ancha fija según alámbrica e inalámbrica (`r FECHA_TITULO_STOCK`)
```{r}
serie_64 <- banda_ancha_servicios %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(alambrica) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_64 %>% 
  pie_chart(servicios, alambrica) %>% 
  print
```


## 44. Servicios de banda ancha fija por velocidad (`r FECHA_TITULO_STOCK`)
```{r}
serie_65 <- banda_ancha_servicios %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(velocidad) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_65 %>% 
  barras_horizontales(servicios, velocidad, nudge_text = 1e5)
```


## 45. Servicios de banda ancha fija por tipo de cliente (`r FECHA_TITULO_STOCK`)
```{r}
serie_66 <- banda_ancha_servicios %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(cliente) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_66 %>% 
  pie_chart(servicios, cliente, 
              nudge_radio=c(.7), 
              nudge_x=c(0, -3, 3), 
              nudge_y=c(0)) %>% 
  print
```


## 46. Servicios de banda ancha fija por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_67 <- banda_ancha_servicios %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), month(fecha) ==    month(FECHA_INFORME_ANUAL)) %>% 
  group_by(empresa) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_67 %>% 
  filter(servicios > 0) %>% 
  barras_horizontales(servicios, empresa, nudge_text = 1e5)
```

## 47. Servicios de banda ancha fija por medio de trasmisión (`r FECHA_TITULO_STOCK`)
```{r}
serie_68 <- banda_ancha_servicios %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(medio) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_68 %>% 
  barras_horizontales(servicios, medio, nudge_text=8e4)
```

```{r, include = FALSE}
banda_ancha_servicios_residenciales <- filter(banda_ancha_servicios, cliente == "Residencial")

```

## 48. Servicios de banda ancha fija residencial
```{r}

serie_69 <- banda_ancha_servicios_residenciales %>% 
  group_by(year=year(fecha), month=month(fecha)) %>%
  summarize(servicios = sum(val, na.rm = TRUE)) %>% 
  select(year, month, servicios)

serie_69 %>% 
  filter(month %in% c(6, 12)) %>% 
  serie_historica_mensual(servicios, nudge_text = 8e4)

```

## 49. Servicios de banda ancha fija residencial por velocidad (`r FECHA_TITULO_STOCK`)
```{r}
serie_70 <- banda_ancha_servicios_residenciales %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(velocidad) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_70 %>% 
  filter(servicios > 0) %>% 
  pie_chart(servicios, velocidad, nudge_y = c(2, -2, 0)) %>% 
  print
```


## 50. Servicios de banda ancha fija residencial por operador (`r FECHA_TITULO_STOCK`)

```{r}
serie_71 <- banda_ancha_servicios_residenciales %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(empresa) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

 serie_71 %>% 
  filter(servicios > 100) %>% # 
  pie_chart(servicios, empresa) %>% 
   print
```

## 51. Servicios de banda ancha fija residencial por medio de trasmisión (`r FECHA_TITULO_STOCK`)
```{r}
serie_72 <- banda_ancha_servicios_residenciales %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(medio) %>% 
  summarize(servicios = sum(val, na.rm = TRUE)) 

serie_72 %>% 
  barras_horizontales(servicios, medio, nudge_text=8e4)

```

```{r, include =FALSE}
banda_ancha_servicios_empresariales <- filter(banda_ancha_servicios, cliente == "Empresarial")

```

## 52. Servicios de banda ancha fija comercial
```{r}
serie_73 <- banda_ancha_servicios_empresariales %>% 
  group_by(year=year(fecha), month=month(fecha)) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_73 %>% 
  filter(month %in% c(6, 12)) %>% 
  serie_historica_mensual(servicios, nudge_text = 1e3)
```


## 53. Servicios de banda ancha fija comercial por velocidad (`r FECHA_TITULO_STOCK`)
```{r}
serie_74 <- banda_ancha_servicios_empresariales %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(velocidad) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_74 %>% 
  barras_horizontales(servicios, velocidad, nudge_text=1e3)
```


## 54. Servicios de banda ancha fija comercial por operador (`r FECHA_TITULO_STOCK`)

```{r}
serie_75 <- banda_ancha_servicios_empresariales %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(empresa) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_75 %>% 
  barras_horizontales(servicios, empresa, nudge_text = 1e3)
```


## 55. Servicios de banda ancha fija comercial por medio de trasmisión (`r FECHA_TITULO_STOCK`)
```{r}
serie_76 <- banda_ancha_servicios_empresariales %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(medio) %>% 
  summarize(servicios = sum(val, na.rm = TRUE)) 

serie_76 %>% 
  pie_chart(servicios, medio, nudge_radio = .7) %>% 
  print
```


```{r}
banda_ancha_servicios_gobierno <- filter(banda_ancha_servicios, cliente == "Gobierno")

```


<!-- ## 77. Servicios de banda ancha fija gobierno -->
<!-- ```{r} -->
<!-- g_77 -->
<!-- ``` -->


<!-- ## 78. Servicios de banda ancha fija gobierno por velocidad -->
<!-- ```{r} -->
<!-- g_78 -->
<!-- ``` -->


<!-- ## 79. Servicios de banda ancha fija gobierno por operador -->
<!-- ```{r} -->
<!-- g_79 -->
<!-- ``` -->


<!-- ## 80. Servicios de banda ancha fija gobierno por medio de trasmisión -->
<!-- ```{r} -->
<!-- g_80 -->
<!-- ``` -->



```{r, include=FALSE}

banda_ancha_servicios_inalambrica <- filter(banda_ancha_servicios, alambrica=="Inalámbrica")


```

## 56. Servicios de banda ancha fija inalámbrica
```{r}
serie_81 <- banda_ancha_servicios_inalambrica %>% 
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), month = month(fecha)) %>% 
  summarize(val = sum(val, na.rm = TRUE))

 serie_81 %>% 
  serie_historica_mensual(val, nudge_text = 3000)
```


## 57. Servicios de banda ancha fija inalámbrica por velocidad (`r FECHA_TITULO_STOCK`)
```{r}
serie_82 <- banda_ancha_servicios_inalambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(velocidad) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_82 %>% 
  barras_horizontales(servicios, velocidad, nudge_text = 5e3)
```


## 58. Servicios de banda ancha fija inalámbrica por tipo de cliente (`r FECHA_TITULO_STOCK`)
```{r}
serie_83 <- banda_ancha_servicios_inalambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(cliente) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_83 %>% 
  pie_chart(servicios, cliente, 
              nudge_radio = c(.6, .7, .7), 
              nudge_x=c(0, -2, 2)) %>% 
  print
```

## 59. Servicios de banda ancha fija inalámbrica por operador (`r FECHA_TITULO_STOCK`)
```{r}
serie_84 <- banda_ancha_servicios_inalambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(empresa) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_84 %>% 
  barras_horizontales(servicios, empresa, nudge_text = 4e3)
```


## 60. Servicios de banda ancha fija inalámbrica por medio de trasmisión (`r FECHA_TITULO_STOCK`)
```{r}
serie_85 <- banda_ancha_servicios_inalambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(medio) %>% 
  summarize(servicios = sum(val, na.rm = TRUE))

serie_85 %>% 
  pie_chart(servicios, medio) %>% 
  print
```


```{r, include=FALSE}

banda_ancha_servicios_alambrica <- filter(banda_ancha_servicios, alambrica=="Alámbrica")


```

## 61. Servicios de banda ancha fija alámbrica
```{r}
serie_86 <- banda_ancha_servicios_alambrica %>%
  filter(month(fecha) %in% c(6, 12)) %>% 
  group_by(year=year(fecha), month = month(fecha)) %>% 
  summarize(val = sum(val, na.rm = TRUE))

serie_86 %>% 
  serie_historica_mensual(val, nudge_text = .5e5)

```


## 62. Servicios de banda ancha fija alámbrica por velocidad (`r FECHA_TITULO_STOCK`)
```{r}
serie_87 <- banda_ancha_servicios_alambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(velocidad) %>% 
  summarize(servicios = sum(val, na.rm = TRUE)) %>% 
  filter(servicios >0)

serie_87 %>% 
  pie_chart(servicios, velocidad) %>% 
  print
```


## 63. Servicios de banda ancha fija alámbrica por medio de trasmisión (`r FECHA_TITULO_STOCK`)
```{r}
serie_88 <- banda_ancha_servicios_alambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(medio) %>% 
  summarize(servicios = sum(val, na.rm = TRUE)) %>% 
  filter(servicios >0)

serie_88 %>% 
  pie_chart(servicios, medio) %>% 
  print
```

## 64. Servicios de banda ancha fija alámbrica por tipo de cliente (`r FECHA_TITULO_STOCK`)
```{r}
serie_89 <- banda_ancha_servicios_alambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(cliente) %>% 
  summarize(servicios = sum(val, na.rm = TRUE)) %>% 
  filter(servicios >0)

serie_89 %>% 
  pie_chart(servicios, cliente, nudge_x=c(0, -4, 4)) %>% 
  print
```


## 65. Servicios de banda ancha fija alámbrica por operador (`r FECHA_TITULO_STOCK`)

```{r}
serie_90 <- banda_ancha_servicios_alambrica %>% 
  filter(year(fecha) == year(FECHA_INFORME_ANUAL), 
         month(fecha) == month(FECHA_INFORME_ANUAL)) %>% 
  group_by(empresa) %>% 
  summarize(servicios = sum(val, na.rm = TRUE)) %>% 
  filter(servicios >0)

serie_90 %>% 
  pie_chart(servicios, empresa) %>% 
  print

```

## 66. Tráfico de datos de servicios de banda ancha fija (terabytes)

```{r}
serie_91 <- tibble(
  fecha = seq(as.Date('2018-01-01'),as.Date('2019-12-01'),by = 'month'),
  trafico = c(96437, 93333, 101713, 101240,
               109307, 108967,112982,
               115621, 115825, 114350, 114150,
               111965, 120039,
               118777, 111572, 126237, 134348,
               142193, 150576, 151067,
               146393, 155685, 143900, 155142)) %>% 
  mutate(year= year(fecha), month= month(fecha)) %>% 
  select(-fecha)

serie_91 %>% 
  filter(year > 2018) %>% 
  serie_historica_mensual(trafico, nudge_text=1e4)
```


## 67. Tráfico de datos de servicios de banda ancha fija (terabytes) según alámbrica e inalámbrica (`r FECHA_TITULO_FLUJO`)

```{r}
serie_92 <- tibble(
  tipo=c("Alámbrica",	"Inalámbrica"),
  trafico=c(1617219,	38710)
)

serie_92 %>% 
  pie_chart(trafico, tipo) %>% 
  print
```

## 68. Tráfico de datos se servicios de banda ancha fija (terabytes) según tipo de cliente (`r FECHA_TITULO_FLUJO`)

```{r}
serie_93 <- tibble(
  cliente= c("Residenciales",	"Comerciales", 	"Gobierno"),
  trafico=c(1587200,	50526,	18203)
)

serie_93 %>% 
  pie_chart(trafico, cliente, 
              nudge_radio = c(.7, .6, .6),
              nudge_x = c(0, -6, 6)) %>% 
  print
```


## 69. Tráfico de datos (terabytes) por operador (`r FECHA_TITULO_FLUJO`)

```{r}
serie_94 <- tibble(
  empresa = c("Antel",	"Dedicado",	"Kalil",	"Enalur",	"Movistar",	"Claro"),
  trafico = c(1650584,	0,	495,	0,	3966, 884))

serie_94 %>% 
  barras_horizontales(trafico, empresa, nudge_text= 1.5e5)
```



